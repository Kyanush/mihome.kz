function gerArrayFilters(){var t=[];return $("#filterpro").serializeArray().forEach(function(e,a){t[e.name]||(t[e.name]=[]),t[e.name].push(e.value)}),t}function urlParamsGenerate(){var t=gerArrayFilters(),e="";t.page>1&&(e+="page-"+t.page+"/"),Object.keys(t).forEach(function(a){if(t[a]&&"page"!=a&&"category"!=a){var r=t[a];$.isArray(t[a])&&(r="",$.each(t[a],function(t,e){e&&(r+=e+"-or-")}),r&&(r=r.slice(0,-4))),r&&(e+=a+"-"+r+"/")}}),$(".sort_select").val()&&(e+=$(".sort_select").val()+"/"),e&&(e=e.slice(0,-1));var a=baseUrl();location.href=a+(e?"/filters/"+e:"")}function filtersClear(){location.href=baseUrl()}function baseUrl(){var t=window.location.origin+window.location.pathname;t=t.split("/");var e="/",a=!0;return t.forEach(function(t,r){r>2&&a&&("filters"==t?a=!1:e+=t+"/")}),e=e.substring(0,e.length-1),t[0]+"//"+t[2]+e}function getCsrfToken(){return $('meta[name="csrf-token"]').attr("content")}function productFeaturesWishlist(t,e){getProduct(e,function(a){$.ajax({url:"/product-features-wishlist/"+e,type:"post",data:{_token:getCsrfToken()},dataType:"json",success:function(e){e&&($(t).hasClass("active")?$(t).removeClass("active"):($(t).addClass("active"),Swal({title:"Закладки",html:'<p class="text-swal2">Товар <a href="'+a.detailUrlProduct+'">'+a.product.name+'</a> добавлен в <a href="/wishlist">закладки</a>!</p>'})),"object"==typeof header&&header.getProductFeaturesWishlistCount())},error:function(t,e,r){401==t.status&&Swal({title:"Закладки",html:'<p class="text-swal2">Необходимо войти в <a href="/login">Личный Кабинет</a> или <a href="/register">создать учетную запись</a>, чтобы сохранить товар <a href="'+a.detailUrlProduct+'">'+a.product.name+'</a> в свои <a href="/wishlist">закладки</a>!</p>'})}})})}function getProduct(t,e){axios.post("/get-product/"+t).then(function(t){var a=t.data;e(a)}).catch(function(t){alert("error")})}function productFeaturesCompare(t,e){getProduct(e,function(a){$.ajax({url:"/product-features-compare/"+e,type:"post",data:{_token:getCsrfToken()},dataType:"json",success:function(e){e&&($(t).hasClass("active")?$(t).removeClass("active"):($(t).addClass("active"),Swal({title:"Сравнение товаров",html:'<p class="text-swal2">Вы добавили <a href="'+a.detailUrlProduct+'">'+a.product.name+'</a> в ваш <a href="/compare-products">список сравнения</a>!</p>'})),"object"==typeof header&&header.getProductFeaturesCompareCount())}})})}function productReviewSetLike(t,e,a){$.ajax({url:"/product-review-set-like",type:"post",dataType:"json",data:{review_id:t,like:e,_token:getCsrfToken()},success:function(t){a(t)},error:function(t,e,r){422==t.status&&swalErrors(t.responseJSON.errors,"Ошибка 422"),a(!1)}})}function addToCart(t,e){if(e||(e=0),t>0){var a=!1;return $.ajax({async:!1,url:"/cart-save",type:"post",data:{product_id:t,quantity:e,_token:getCsrfToken()},dataType:"json",success:function(t){a=!0}}),a}alert("Error")}function swalErrors(t,e,a){e||(e="Ошибка"),a||(a="error");var r="";$.each(t,function(t,e){r+=e+"<br/>"}),Swal({type:a,title:e,html:r})}function setCity(t){axios.post("/set-city/"+t,{_token:getCsrfToken()}).then(function(t){location.href="/"})}function subscribe(t){var e=getFormData(t);ajaxLoader(t,!0),$.ajax({type:"POST",url:"/subscribe",data:e,success:function(a){if(a){var r=e.product_id?"Вы успешно подписались на уведомление о поступлении товара":"Вы успешно подписались на наши новости!",o=e.product_id?"Подписка на товары":"Подписка";Swal({title:o,html:r})}else Swal({type:"error",title:"Подписка",html:"Вы уже подписаны!"});clearFormData(t),ajaxLoader(t,!1)},error:function(e,a,r){422==e.status&&swalErrors(e.responseJSON.errors,"Ошибка 422"),ajaxLoader(t,!1)}})}function getFormData(t){var e=$(t).serializeArray(),a={};return e.forEach(function(t,e){a[t.name]=t.value}),a}function clearFormData(t){$(t).find("input[type=text]").val(""),$(t).find("input[type=email]").val(""),$(t).find("input[type=password]").val(""),$(t).find("textarea").val("")}function ajaxLoader(t,e){e?$(t).find(".ajax-loader").addClass("active"):$(t).find(".ajax-loader").removeClass("active")}function validSelectModelProduct(){return!$("#select-model-product").length||(!!$("#select-model-product").val()||(Swal({title:"ВНИМАНИЕ",html:'Выберите модель товара (цвет, память), нажав на поле "Выберите варинат"'}),!1))}$(document).ready(function(){$(".sort_select, #min_price, #max_price").on("change",function(){urlParamsGenerate()})}),$(document).ready(function(){$(".phone-mask").length>0&&$(".phone-mask").mask("+7(999)999-99-99")}),$(document).ready(function(){if(setInterval(function(){var t=$(".lis-sys-rating-average").text(),e=$(".lis-sys-rating-votes-count").text(),a=$("#product_id").val();t&&e&&a&&axios.post("/set-rating",{reviews_rating_avg:t,reviews_count:e,product_id:a}).then(function(t){}).catch(function(t){})},2e3),$("img.lazy").lazyload({effect:"fadeIn",threshold:300}),$(".uk-slider").length>0)for(var t=$(".uk-slider").find("img.lazy"),e=0;e<t.length;e++)$(t[e]).attr("src",$(t[e]).data("original"));$("#select-model-product").on("change",function(){var t=$(this).val();t&&(window.location=t)})});